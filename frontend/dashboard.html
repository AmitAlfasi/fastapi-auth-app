<!DOCTYPE html>
<!-- 
    Dashboard/Home Page
    This is the authenticated user's home page.
    Features:
    - Protected route (requires valid access token)
    - Displays personalized welcome message
    - Logout functionality
    - Automatic redirect to login if unauthorized
    - Fetches user data from protected API endpoint
-->
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Home</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h2>Home</h2>
        <p id="welcome-message">Loading...</p>
        <div class="logout-container">
            <button onclick="logout()">Logout</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        async function fetchUserHome() {
            const response = await fetchWithAuth("http://127.0.0.1:8000/user/home");

            if (!response || !response.ok) {
                console.error("Unable to fetch user data");
                return;
            }

            const data = await response.json();
            document.getElementById("welcome-message").textContent = data.message;
        }

        function logout() {
            localStorage.removeItem("access_token");
            window.location.href = "index.html";
        }

        fetchUserHome();
    </script>

</body>

</html>